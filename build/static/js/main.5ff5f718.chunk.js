(this.webpackJsonpauctioneer=this.webpackJsonpauctioneer||[]).push([[0],{58:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(24),a=n(11),s=n(68),i=n(41),o=(n(49),n(59),n(60),i.a.initializeApp({apiKey:"AIzaSyCqG_1hm7AJN58pyBj_lbMecOtwP2NXbzQ",authDomain:"taxis-stackblitz.firebaseapp.com",projectId:"taxis-stackblitz",storageBucket:"taxis-stackblitz.appspot.com",messagingSenderId:"977311415632",appId:"1:977311415632:web:c4a419e65259ff87fa8055"})),j=i.a.firestore.FieldValue.serverTimestamp,l=o.firestore(),u=o.storage(),d=o.auth(),b=n(2),O=Object(c.createContext)(),x=function(e){var t=e.children,n=Object(c.useState)(null),r=Object(a.a)(n,2),s=r[0],i=r[1],o=Object(c.useState)(!0),j=Object(a.a)(o,2),u=j[0],x=j[1],h=Object(c.useState)(""),m=Object(a.a)(h,2),p=m[0],f=m[1];return Object(c.useEffect)((function(){return d.onAuthStateChanged((function(e){i(e),x(!1)}))}),[]),Object(c.useEffect)((function(){var e=setTimeout((function(){return f("")}),5e3);return function(){return clearTimeout(e)}}),[p]),Object(b.jsx)(O.Provider,{value:{currentUser:s,register:function(e,t){return d.createUserWithEmailAndPassword(e,t)},login:function(e,t){return d.signInWithEmailAndPassword(e,t)},logout:function(){return d.signOut()},bidAuction:function(e,t){return l.collection("orders").doc(e,t).update({entregado:!0,deliver:t})},endAuction:function(e){return l.collection("auctions").doc(e).delete()},globalMsg:p},children:!u&&t})},h=n(21),m=function(e){var t=Object(c.useState)([]),n=Object(a.a)(t,2),r=n[0],s=n[1];return Object(c.useEffect)((function(){var t=l.collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(h.a)(Object(h.a)({},e.data()),{},{id:e.id}))})),s(t)}));return function(){return t()}}),[e]),{docs:r}},p=function(e){var t=e.orden,n=Object(c.useContext)(O),r=n.currentUser,s=n.bidAuction,i=m("orders").docs,o=function(e){var t=Object(c.useState)([]),n=Object(a.a)(t,2),r=n[0],s=n[1];return Object(c.useEffect)((function(){var t=l.collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(Object(h.a)(Object(h.a)({},e.data()),{},{id:e.id}))})),s(t)}));return function(){return t()}}),[e]),{items:r}}("items").items;console.log("docs:",i),console.log("items:",o);var j,u=t.entregado?"entregando...":"Apartar para Entregar",d=t.date.toDate().toLocaleTimeString(),x=t.date.toDate().toLocaleDateString("es-CL",{weekday:"long",year:"numeric",month:"short",day:"numeric"});return Object(b.jsx)("div",{children:r&&Object(b.jsxs)("div",{className:" pl-5 col-sm-4 m-1 p-3 my-3 bg-white ",children:[Object(b.jsxs)("h6",{children:["Id-Orden: ",Object(b.jsx)("span",{className:"text-danger",children:t.id}),"  "]}),Object(b.jsxs)("p",{children:[" ",Object(b.jsx)("span",{className:"text-muted",children:"comprador:"})," ",t.buyer.name," "]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"correo:"}),"  ",t.buyer.email," "]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"telefono:"})," ",t.buyer.phone," "]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"fecha:"}),"  ",x,", ",d]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"direccion:"}),"  ",t.buyer.adress]}),Object(b.jsx)("br",{}),t.items.map((function(e,t){return Object(b.jsxs)("div",{children:[Object(b.jsxs)("h6",{children:["Id-producto: ",Object(b.jsx)("span",{className:"text-danger",children:e.id})," "]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"producto:"}),"  ",e.item]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"precio:"}),"  ",e.price]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("span",{className:"text-muted",children:"cantidad:"}),"  ",e.qty]}),o.map((function(t){return console.log(t.id===e.id?j=t.pictureUrl[0]:null)})),Object(b.jsx)("img",{className:"col-4 mb-1",src:j,alt:""})]},t)})),Object(b.jsx)("br",{}),Object(b.jsxs)("p",{className:"border text-center",children:["Total a Pagar: $",Object(b.jsx)("span",{className:"text-white bg-dark fs-4 py-1 px-2 ",children:t.total})]}),Object(b.jsx)("button",{onClick:function(){return s(t.id,r.email)},className:t.entregado?"btn btn-primary w-100":"btn btn-outline-danger w-100",children:u})]})})},f=n(65),v=n(20),g=n.n(v),y=n(25),w=function(e){var t=Object(c.useState)(0),n=Object(a.a)(t,2),r=n[0],s=n[1],i=Object(c.useState)(null),o=Object(a.a)(i,2),d=o[0],b=o[1];return Object(c.useState)((function(){var t=u.ref(e.itemImage.name),n=l.collection("auctions");t.put(e.itemImage).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;s(t)}),(function(e){console.log(e)}),Object(y.a)(g.a.mark((function c(){var r,a;return g.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getDownloadURL();case 2:return r=c.sent,a=j(),delete e.itemImage,c.next=7,n.add(Object(h.a)(Object(h.a)({},e),{},{createdAt:a,imgUrl:r}));case 7:b(!0);case 8:case"end":return c.stop()}}),c)}))))}),[e]),{progress:r,isCompleted:d}},N=function(e){var t=e.auction,n=e.setAuction,r=w(t),a=r.progress,s=r.isCompleted;return Object(c.useEffect)((function(){s&&n(null)}),[s,n]),Object(b.jsx)(f.a.div,{style:{height:"5px",background:"black"},initial:{width:0},animate:{width:"".concat(a,"%")}})},k=function(){var e=Object(c.useState)(null),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(c.useContext)(O),o=(i.currentUser,i.globalMsg),j=m("orders").docs;return console.log(j),Object(b.jsxs)("div",{className:"",children:[n&&Object(b.jsx)(N,{auction:n,setAuction:r}),Object(b.jsx)("div",{style:{zIndex:"9999999"},className:"text-center w-50 position-fixed top-10 start-50 translate-middle",children:o&&Object(b.jsx)(s.a,{variant:"danger",children:o})}),j&&Object(b.jsx)("div",{className:"container-fluid",children:Object(b.jsx)("div",{className:"",children:j.map((function(e,t){return Object(b.jsx)(p,{orden:e},t)}))})})]})},C=n(66),S=n(67),E=n(64),A=function(){var e=Object(c.useState)(!1),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(""),o=Object(a.a)(i,2),j=o[0],l=o[1],u=Object(c.useRef)(),d=Object(c.useRef)(),x=Object(c.useContext)(O).login,h=function(){return r(!1)},m=function(){var e=Object(y.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),l(""),e.prev=2,e.next=5,x(u.current.value,d.current.value);case 5:h(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),l("Invalid login");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{onClick:function(){return r(!0)},className:"btn btn-dark mx-2",children:"Entrar"}),Object(b.jsx)(C.a,{centered:!0,show:n,onHide:h,children:Object(b.jsxs)("form",{onSubmit:m,children:[Object(b.jsx)(C.a.Header,{children:Object(b.jsx)(C.a.Title,{children:"Entrar"})}),Object(b.jsxs)(C.a.Body,{children:[j&&Object(b.jsx)(s.a,{variant:"danger",children:j}),Object(b.jsxs)(S.a.Group,{children:[Object(b.jsx)(S.a.Label,{children:"Email "}),Object(b.jsx)(S.a.Control,{type:"email",required:!0,ref:u})]}),Object(b.jsxs)(S.a.Group,{children:[Object(b.jsx)(S.a.Label,{children:"Password"}),Object(b.jsx)(S.a.Control,{type:"password",required:!0,ref:d})]})]}),Object(b.jsxs)(C.a.Footer,{children:[Object(b.jsx)(E.a,{variant:"secondary",onClick:h,children:"Cancelar"}),Object(b.jsx)(E.a,{variant:"primary",type:"submit",children:"Entrar"})]})]})})]})},I=function(){var e=Object(c.useState)(!1),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(""),o=Object(a.a)(i,2),j=o[0],l=o[1],u=Object(c.useRef)(),d=Object(c.useRef)(),x=Object(c.useRef)(),h=Object(c.useContext)(O).register,m=function(){return r(!1)},p=function(){var e=Object(y.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),l(""),d.current.value===x.current.value){e.next=4;break}return e.abrupt("return",l("Passwords does not match"));case 4:return e.prev=4,e.next=7,h(u.current.value,d.current.value);case 7:m(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),l(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{onClick:function(){return r(!0)},className:"btn btn-dark m-2",children:"Registro"}),Object(b.jsx)(C.a,{centered:!0,show:n,onHide:m,children:Object(b.jsxs)("form",{onSubmit:p,children:[Object(b.jsx)(C.a.Header,{children:Object(b.jsx)(C.a.Title,{children:"Registro"})}),Object(b.jsxs)(C.a.Body,{children:[j&&Object(b.jsx)(s.a,{variant:"danger",children:j}),Object(b.jsxs)(S.a.Group,{children:[Object(b.jsx)(S.a.Label,{children:"Email"}),Object(b.jsx)(S.a.Control,{type:"email",required:!0,ref:u})]}),Object(b.jsxs)(S.a.Group,{children:[Object(b.jsx)(S.a.Label,{children:"Password"}),Object(b.jsx)(S.a.Control,{type:"password",required:!0,ref:d})]}),Object(b.jsxs)(S.a.Group,{children:[Object(b.jsx)(S.a.Label,{children:"Confirmar Password"}),Object(b.jsx)(S.a.Control,{type:"password",required:!0,ref:x})]})]}),Object(b.jsxs)(C.a.Footer,{children:[Object(b.jsx)(E.a,{variant:"secondary",onClick:m,children:"Cancelar"}),Object(b.jsx)(E.a,{variant:"primary",type:"submit",children:"Registro"})]})]})})]})},L=function(){var e=Object(c.useContext)(O),t=e.currentUser,n=e.logout;return Object(b.jsxs)("nav",{className:"container navbar navbar-light ",children:[Object(b.jsx)("div",{className:"navbar-brand mb-4 w-100 text-center",children:Object(b.jsx)("h1",{children:"nexGym Entregas"})}),Object(b.jsx)("div",{className:"d-flex flex-column w-100",children:t?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:" btn-dark mx-2 disabled mb-2 p-2 text-center",children:t.email}),Object(b.jsx)("div",{onClick:function(){return n()},className:"btn btn-light mx-2",children:"SALIR"})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(A,{}),Object(b.jsx)(I,{})]})})]})},R=function(){return Object(b.jsxs)(x,{children:[Object(b.jsx)(L,{}),Object(b.jsx)(k,{})]})};n(57);Object(r.render)(Object(b.jsx)(R,{}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.5ff5f718.chunk.js.map